<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Circuit Born Machine · Tutorial|Yao</title><link rel="canonical" href="https://tutorials.yaoquantum.org/generated/quick-start/6.quantum-circuit-born-machine/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/main.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/main.css" rel="stylesheet" type="text/css"/><link href="http://yaoquantum.org/favicon.ico" rel="icon" type="image/x-icon"/><link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="top" class="navbar-wrapper">
<nav class="navbar fixed-top navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="https://yaoquantum.org">
        <img src="https://yaoquantum.org/assets/images/logo-light.png">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="#">Tutorial<span class="sr-only">(current)</span></a>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="https://docs.yaoquantum.org/dev">Documentation</a>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="https://yaoquantum.org/benchmark">Benchmark</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="http://yaoquantum.org/soc">SoC</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="http://yaoquantum.org/research">Research</a>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="https://github.com/QuantumBFS/Yao.jl">GitHub</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/CONTRIBUTING.md">Contribute</a>
        </li>
      </ul>
    </div>
</nav>
</div>
<div class="documenter-wrapper" id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Tutorial|Yao</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li><a class="tocitem" href="../2.qft-phase-estimation/">Quantum Fourier Transformation and Phase Estimation</a></li><li><a class="tocitem" href="../3.grover-search/">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/">Shor&#39;s 9 qubit code</a></li><li class="is-active"><a class="tocitem" href>Quantum Circuit Born Machine</a><ul class="internal"><li><a class="tocitem" href="#Training-Target-1"><span>Training Target</span></a></li><li><a class="tocitem" href="#Create-the-Circuit-1"><span>Create the Circuit</span></a></li><li><a class="tocitem" href="#Rotation-Layer-1"><span>Rotation Layer</span></a></li><li><a class="tocitem" href="#Entangler-1"><span>Entangler</span></a></li><li><a class="tocitem" href="#MMD-Loss-and-Gradients-1"><span>MMD Loss &amp; Gradients</span></a></li></ul></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Developer Guide</span><ul><li><a class="tocitem" href="../../developer-guide/1.extending-register/">Extending Register: an echo register</a></li><li><a class="tocitem" href="../../developer-guide/2.cuda-acceleration/">CUDA acceleration of Quantum Simulation</a></li><li><a class="tocitem" href="../../developer-guide/3.extern-libraries/">Using External Libraries</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href>Quantum Circuit Born Machine</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantum Circuit Born Machine</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/tutorials/blob/master/quick-start/6.quantum-circuit-born-machine/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/tutorials/gh-pages?filepath=dev/generated/quick-start/6.quantum-circuit-born-machine/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/tutorials/blob/gh-pages/dev/generated/quick-start/6.quantum-circuit-born-machine/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/6.quantum-circuit-born-machine"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="qcbm-1"><a class="docs-heading-anchor" href="#qcbm-1">Quantum Circuit Born Machine</a><a class="docs-heading-anchor-permalink" href="#qcbm-1" title="Permalink"></a></h1><p>Yao is designed with variational quantum circuits in mind, and this tutorial will introduce how to use Yao for this kind of task by implementing a quantum circuit born machine described in <a href="https://arxiv.org/abs/1804.04168">Jin-Guo Liu, Lei Wang (2018)</a></p><p>let&#39;s use the packages first</p><pre><code class="language-julia">using Yao, LinearAlgebra, Plots</code></pre><h2 id="Training-Target-1"><a class="docs-heading-anchor" href="#Training-Target-1">Training Target</a><a class="docs-heading-anchor-permalink" href="#Training-Target-1" title="Permalink"></a></h2><p>In this tutorial, we will ask the variational circuit to learn the most basic distribution: a guassian distribution. It is defined as follows:</p><div>\[f(x \left| \mu, \sigma^2\right) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}\]</div><p>We implement it as <code>gaussian_pdf</code>:</p><pre><code class="language-julia">function gaussian_pdf(x, μ::Real, σ::Real)
    pl = @. 1 / sqrt(2pi * σ^2) * exp(-(x - μ)^2 / (2 * σ^2))
    pl / sum(pl)
end
pg = gaussian_pdf(1:1&lt;&lt;6, 1&lt;&lt;5-0.5, 1&lt;&lt;4);</code></pre><p>We can plot the distribution, it looks like</p><pre><code class="language-julia">plot(pg)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip5500">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip5500)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip5501">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip5500)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip5502">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  117.189,1521.01 117.189,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  456.477,1521.01 456.477,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  795.764,1521.01 795.764,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1135.05,1521.01 1135.05,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1474.34,1521.01 1474.34,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1813.63,1521.01 1813.63,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2152.92,1521.01 2152.92,47.2441 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1376.9 2352.76,1376.9 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1071.99 2352.76,1071.99 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,767.086 2352.76,767.086 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,462.179 2352.76,462.179 
  "/>
<polyline clip-path="url(#clip5502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,157.272 2352.76,157.272 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  117.189,1521.01 117.189,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  456.477,1521.01 456.477,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  795.764,1521.01 795.764,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1135.05,1521.01 1135.05,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1474.34,1521.01 1474.34,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1813.63,1521.01 1813.63,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2152.92,1521.01 2152.92,1498.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1376.9 120.979,1376.9 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1071.99 120.979,1071.99 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,767.086 120.979,767.086 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,462.179 120.979,462.179 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,157.272 120.979,157.272 
  "/>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 117.189, 1575.01)" x="117.189" y="1575.01">0</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 456.477, 1575.01)" x="456.477" y="1575.01">10</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 795.764, 1575.01)" x="795.764" y="1575.01">20</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1135.05, 1575.01)" x="1135.05" y="1575.01">30</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1474.34, 1575.01)" x="1474.34" y="1575.01">40</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1813.63, 1575.01)" x="1813.63" y="1575.01">50</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2152.92, 1575.01)" x="2152.92" y="1575.01">60</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1394.4)" x="62.9921" y="1394.4">0.005</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1089.49)" x="62.9921" y="1089.49">0.010</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 784.586)" x="62.9921" y="784.586">0.015</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 479.679)" x="62.9921" y="479.679">0.020</text>
</g>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 174.772)" x="62.9921" y="174.772">0.025</text>
</g>
<polyline clip-path="url(#clip5502)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1422.79 185.046,1390.59 218.975,1355.66 252.904,1317.96 286.833,1277.49 320.761,1234.27 354.69,1188.36 388.619,1139.87 422.548,1088.92 456.477,1035.72 
  490.405,980.483 524.334,923.495 558.263,865.073 592.192,805.579 626.12,745.417 660.049,685.025 693.978,624.875 727.907,565.464 761.836,507.311 795.764,450.946 
  829.693,396.904 863.622,345.72 897.551,297.913 931.479,253.983 965.408,214.402 999.337,179.604 1033.27,149.976 1067.19,125.853 1101.12,107.512 1135.05,95.1643 
  1168.98,88.9544 1202.91,88.9544 1236.84,95.1643 1270.77,107.512 1304.7,125.853 1338.62,149.976 1372.55,179.604 1406.48,214.402 1440.41,253.983 1474.34,297.913 
  1508.27,345.72 1542.2,396.904 1576.13,450.946 1610.05,507.311 1643.98,565.464 1677.91,624.875 1711.84,685.025 1745.77,745.417 1779.7,805.579 1813.63,865.073 
  1847.56,923.495 1881.49,980.483 1915.41,1035.72 1949.34,1088.92 1983.27,1139.87 2017.2,1188.36 2051.13,1234.27 2085.06,1277.49 2118.99,1317.96 2152.92,1355.66 
  2186.84,1390.59 2220.77,1422.79 2254.7,1452.33 2288.63,1479.3 
  "/>
<path clip-path="url(#clip5500)" d="
M1989.93 251.724 L2280.76 251.724 L2280.76 130.764 L1989.93 130.764  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip5500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1989.93,251.724 2280.76,251.724 2280.76,130.764 1989.93,130.764 1989.93,251.724 
  "/>
<polyline clip-path="url(#clip5500)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  2013.93,191.244 2157.93,191.244 
  "/>
<g clip-path="url(#clip5500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2181.93, 208.744)" x="2181.93" y="208.744">y1</text>
</g>
</svg>
<h2 id="Create-the-Circuit-1"><a class="docs-heading-anchor" href="#Create-the-Circuit-1">Create the Circuit</a><a class="docs-heading-anchor-permalink" href="#Create-the-Circuit-1" title="Permalink"></a></h2><p>A quantum circuit born machine looks like the following:</p><p><img src="assets/differentiable.png" alt="differentiable ciruit"/></p><p>It is composited by two different layers: <strong>rotation layer</strong> and <strong>entangler layer</strong>.</p><h2 id="Rotation-Layer-1"><a class="docs-heading-anchor" href="#Rotation-Layer-1">Rotation Layer</a><a class="docs-heading-anchor-permalink" href="#Rotation-Layer-1" title="Permalink"></a></h2><p>Arbitrary rotation is built with <strong>Rotation Gate</strong> on <strong>Z, X, Z</strong> axis with parameters.</p><div>\[Rz(\theta) \cdot Rx(\theta) \cdot Rz(\theta)\]</div><p>Since our input will be a <span>$|0\dots 0\rangle$</span> state. The first layer of arbitrary rotation can just use <span>$Rx(\theta) \cdot Rz(\theta)$</span> and the last layer of arbitrary rotation could just use <span>$Rz(\theta)\cdot Rx(\theta)$</span></p><p>In <strong>幺</strong>, every Hilbert operator is a <strong>block</strong> type, this ncludes all <strong>quantum gates</strong> and <strong>quantum oracles</strong>. In general, operators appears in a quantum circuit can be divided into <strong>Composite Blocks</strong> and <strong>Primitive Blocks</strong>.</p><p>We follow the low abstraction principle and thus each block represents a certain approach of calculation. The simplest <strong>Composite Block</strong> is a <strong>Chain Block</strong>, which chains other blocks (oracles) with the same number of qubits together. It is just a simple mathematical composition of operators with same size. e.g.</p><div>\[\text{chain(X, Y, Z)} \iff X \cdot Y \cdot Z\]</div><p>We can construct an arbitrary rotation block by chain <span>$Rz$</span>, <span>$Rx$</span>, <span>$Rz$</span> together.</p><pre><code class="language-julia">chain(Rz(0.0), Rx(0.0), Rz(0.0))</code></pre><pre><code class="language-none">nqubits: 1
chain
├─ rot(Z gate, 0.0)
├─ rot(X gate, 0.0)
└─ rot(Z gate, 0.0)</code></pre><p><code>Rx</code>, <code>Rz</code> will construct new rotation gate, which are just shorthands for <code>rot(X, 0.0)</code>, etc.</p><p>Then let&#39;s chain them up</p><pre><code class="language-julia">layer(nbit::Int, x::Symbol) = layer(nbit, Val(x))
layer(nbit::Int, ::Val{:first}) = chain(nbit, put(i=&gt;chain(Rx(0), Rz(0))) for i = 1:nbit);</code></pre><p>We do not need to feed the first <code>n</code> parameter into <code>put</code> here. All factory methods can be <strong>lazy</strong> evaluate <strong>the first arguements</strong>, which is the number of qubits. It will return a lambda function that requires a single interger input. The instance of desired block will only be constructed until all the information is filled. When you filled all the information in somewhere of the declaration, 幺 will be able to infer the others. We will now define the rest of rotation layers</p><pre><code class="language-julia">layer(nbit::Int, ::Val{:last}) = chain(nbit, put(i=&gt;chain(Rz(0), Rx(0))) for i = 1:nbit)
layer(nbit::Int, ::Val{:mid}) = chain(nbit, put(i=&gt;chain(Rz(0), Rx(0), Rz(0))) for i = 1:nbit);</code></pre><h2 id="Entangler-1"><a class="docs-heading-anchor" href="#Entangler-1">Entangler</a><a class="docs-heading-anchor-permalink" href="#Entangler-1" title="Permalink"></a></h2><p>Another component of quantum circuit born machine are several <strong>CNOT</strong> operators applied on different qubits.</p><pre><code class="language-julia">entangler(pairs) = chain(control(ctrl, target=&gt;X) for (ctrl, target) in pairs);</code></pre><p>We can then define such a born machine</p><pre><code class="language-julia">function build_circuit(n, nlayers, pairs)
    circuit = chain(n)
    push!(circuit, layer(n, :first))
    for i in 2:nlayers
        push!(circuit, cache(entangler(pairs)))
        push!(circuit, layer(n, :mid))
    end
    push!(circuit, cache(entangler(pairs)))
    push!(circuit, layer(n, :last))
    return circuit
end</code></pre><pre><code class="language-none">build_circuit (generic function with 1 method)</code></pre><p>We use the method <code>cache</code> here to tag the entangler block that it should be cached after its first run, because it is actually a constant oracle. Let&#39;s see what will be constructed</p><pre><code class="language-julia">build_circuit(4, 1, [1=&gt;2, 2=&gt;3, 3=&gt;4])</code></pre><pre><code class="language-none">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ chain
│  │     ├─ rot(X gate, 0.0)
│  │     └─ rot(Z gate, 0.0)
│  ├─ put on (2)
│  │  └─ chain
│  │     ├─ rot(X gate, 0.0)
│  │     └─ rot(Z gate, 0.0)
│  ├─ put on (3)
│  │  └─ chain
│  │     ├─ rot(X gate, 0.0)
│  │     └─ rot(Z gate, 0.0)
│  └─ put on (4)
│     └─ chain
│        ├─ rot(X gate, 0.0)
│        └─ rot(Z gate, 0.0)
├─ [cached] chain
│     ├─ control(1)
│     │  └─ (2,) X gate
│     ├─ control(2)
│     │  └─ (3,) X gate
│     └─ control(3)
│        └─ (4,) X gate
└─ chain
   ├─ put on (1)
   │  └─ chain
   │     ├─ rot(Z gate, 0.0)
   │     └─ rot(X gate, 0.0)
   ├─ put on (2)
   │  └─ chain
   │     ├─ rot(Z gate, 0.0)
   │     └─ rot(X gate, 0.0)
   ├─ put on (3)
   │  └─ chain
   │     ├─ rot(Z gate, 0.0)
   │     └─ rot(X gate, 0.0)
   └─ put on (4)
      └─ chain
         ├─ rot(Z gate, 0.0)
         └─ rot(X gate, 0.0)
</code></pre><h2 id="MMD-Loss-and-Gradients-1"><a class="docs-heading-anchor" href="#MMD-Loss-and-Gradients-1">MMD Loss &amp; Gradients</a><a class="docs-heading-anchor-permalink" href="#MMD-Loss-and-Gradients-1" title="Permalink"></a></h2><p>The MMD loss is describe below:</p><div>\[\begin{aligned}
\mathcal{L} &amp;= \left| \sum_{x} p \theta(x) \phi(x) - \sum_{x} \pi(x) \phi(x) \right|^2\\
            &amp;= \langle K(x, y) \rangle_{x \sim p_{\theta}, y\sim p_{\theta}} - 2 \langle K(x, y) \rangle_{x\sim p_{\theta}, y\sim \pi} + \langle K(x, y) \rangle_{x\sim\pi, y\sim\pi}
\end{aligned}\]</div><p>We will use a squared exponential kernel here.</p><pre><code class="language-julia">struct RBFKernel
    σ::Float64
    m::Matrix{Float64}
end

function RBFKernel(σ::Float64, space)
    dx2 = (space .- space&#39;).^2
    return RBFKernel(σ, exp.(-1/2σ * dx2))
end

kexpect(κ::RBFKernel, x, y) = x&#39; * κ.m * y</code></pre><pre><code class="language-none">kexpect (generic function with 1 method)</code></pre><p>There are two different way to define the loss:</p><p>In simulation we can use the probability distribution of the state directly</p><pre><code class="language-julia">get_prob(qcbm) = probs(zero_state(nqubits(qcbm)) |&gt; qcbm)

function loss(κ, c, target)
    p = get_prob(c) - target
    return kexpect(κ, p, p)
end</code></pre><pre><code class="language-none">loss (generic function with 1 method)</code></pre><p>Or if you want to simulate the whole process with measurement (which is entirely physical), you should define the loss with measurement results, for convenience we directly use the simulated results as our loss</p><h3 id="Gradients-1"><a class="docs-heading-anchor" href="#Gradients-1">Gradients</a><a class="docs-heading-anchor-permalink" href="#Gradients-1" title="Permalink"></a></h3><p>the gradient of MMD loss is</p><div>\[\begin{aligned}
\frac{\partial \mathcal{L}}{\partial \theta^i_l} &amp;= \langle K(x, y) \rangle_{x\sim p_{\theta^+}, y\sim p_{\theta}} - \langle K(x, y) \rangle_{x\sim p_{\theta}^-, y\sim p_{\theta}}\\
&amp;- \langle K(x, y) \rangle _{x\sim p_{\theta^+}, y\sim\pi} + \langle K(x, y) \rangle_{x\sim p_{\theta^-}, y\sim\pi}
\end{aligned}\]</div><p>which can be implemented as</p><pre><code class="language-julia">function gradient(qcbm, κ, ptrain)
    n = nqubits(qcbm)
    prob = get_prob(qcbm)
    grad = zeros(Float64, nparameters(qcbm))

    count = 1
    for k in 1:2:length(qcbm), each_line in qcbm[k], gate in content(each_line)
        dispatch!(+, gate, π/2)
        prob_pos = probs(zero_state(n) |&gt; qcbm)

        dispatch!(-, gate, π)
        prob_neg = probs(zero_state(n) |&gt; qcbm)

        dispatch!(+, gate, π/2) # set back

        grad_pos = kexpect(κ, prob, prob_pos) - kexpect(κ, prob, prob_neg)
        grad_neg = kexpect(κ, ptrain, prob_pos) - kexpect(κ, ptrain, prob_neg)
        grad[count] = grad_pos - grad_neg
        count += 1
    end
    return grad
end</code></pre><pre><code class="language-none">gradient (generic function with 1 method)</code></pre><p>Now let&#39;s setup the training</p><pre><code class="language-julia">using Flux.Optimise
qcbm = build_circuit(6, 10, [1=&gt;2, 3=&gt;4, 5=&gt;6, 2=&gt;3, 4=&gt;5, 6=&gt;1])
dispatch!(qcbm, :random) # initialize the parameters

κ = RBFKernel(0.25, 0:2^6-1)
pg = gaussian_pdf(1:1&lt;&lt;6, 1&lt;&lt;5-0.5, 1&lt;&lt;4);
opt = ADAM()

function train(qcbm, κ, opt, target)
    history = Float64[]
    for _ in 1:100
        push!(history, loss(κ, qcbm, target))
        ps = parameters(qcbm)
        Optimise.update!(opt, ps, gradient(qcbm, κ, target))
        popdispatch!(qcbm, ps)
    end
    return history
end

history = train(qcbm, κ, opt, pg)
trained_pg = probs(zero_state(nqubits(qcbm)) |&gt; qcbm)</code></pre><pre><code class="language-none">64-element Array{Float64,1}:
 0.00549891887475637   
 0.009503262883199585  
 0.006294199899822892  
 0.00929419001133182   
 0.011550782753923012  
 0.004039574196181684  
 0.005461823125591058  
 0.008990844456096766  
 0.004422359090348145  
 0.010719577781963262  
 ⋮                     
 0.006975308669678806  
 0.012131157988806887  
 0.0048592096077257054 
 0.0072683568313054395 
 0.0018430977117108334 
 0.0005774027621542278 
 0.009326211675909917  
 0.00028031096980839904
 0.0061229520561284796 </code></pre><p>The history of training looks like below</p><pre><code class="language-julia">title!(&quot;training history&quot;)
xlabel!(&quot;steps&quot;); ylabel!(&quot;loss&quot;)
plot(history)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip6100">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6100)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6101">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6100)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6102">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  129.526,1521.01 129.526,47.2441 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  669.302,1521.01 669.302,47.2441 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1209.08,1521.01 1209.08,47.2441 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1748.85,1521.01 1748.85,47.2441 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1236.8 2352.76,1236.8 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,947.822 2352.76,947.822 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,658.845 2352.76,658.845 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,369.867 2352.76,369.867 
  "/>
<polyline clip-path="url(#clip6102)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,80.889 2352.76,80.889 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  129.526,1521.01 129.526,1498.9 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  669.302,1521.01 669.302,1498.9 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1209.08,1521.01 1209.08,1498.9 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1748.85,1521.01 1748.85,1498.9 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1498.9 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1236.8 120.979,1236.8 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,947.822 120.979,947.822 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,658.845 120.979,658.845 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,369.867 120.979,369.867 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,80.889 120.979,80.889 
  "/>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 129.526, 1575.01)" x="129.526" y="1575.01">0</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 669.302, 1575.01)" x="669.302" y="1575.01">25</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1209.08, 1575.01)" x="1209.08" y="1575.01">50</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1748.85, 1575.01)" x="1748.85" y="1575.01">75</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2288.63, 1575.01)" x="2288.63" y="1575.01">100</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 1254.3)" x="62.9921" y="1254.3">0.005</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 965.322)" x="62.9921" y="965.322">0.010</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 676.345)" x="62.9921" y="676.345">0.015</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 387.367)" x="62.9921" y="387.367">0.020</text>
</g>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 62.9921, 98.389)" x="62.9921" y="98.389">0.025</text>
</g>
<polyline clip-path="url(#clip6102)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,88.9544 172.709,131.722 194.3,173.528 215.891,214.345 237.482,254.148 259.073,292.914 280.664,330.64 302.255,367.367 323.846,403.083 345.437,437.771 
  367.028,471.421 388.619,504.034 410.21,535.636 431.801,566.253 453.392,595.925 474.983,624.694 496.574,652.561 518.165,679.559 539.756,705.712 561.347,731.049 
  582.938,755.59 604.529,779.33 626.12,802.292 647.711,824.48 669.302,845.922 690.894,866.626 712.485,886.626 734.076,905.961 755.667,924.628 777.258,942.646 
  798.849,960.034 820.44,976.796 842.031,992.961 863.622,1008.56 885.213,1023.59 906.804,1038.11 928.395,1052.14 949.986,1065.73 971.577,1078.88 993.168,1091.62 
  1014.76,1103.94 1036.35,1115.86 1057.94,1127.43 1079.53,1138.66 1101.12,1149.55 1122.71,1160.12 1144.31,1170.36 1165.9,1180.28 1187.49,1189.89 1209.08,1199.21 
  1230.67,1208.25 1252.26,1217.03 1273.85,1225.56 1295.44,1233.85 1317.03,1241.9 1338.62,1249.74 1360.22,1257.35 1381.81,1264.74 1403.4,1271.92 1424.99,1278.88 
  1446.58,1285.63 1468.17,1292.16 1489.76,1298.48 1511.35,1304.63 1532.94,1310.66 1554.54,1316.58 1576.13,1322.4 1597.72,1328.14 1619.31,1333.8 1640.9,1339.38 
  1662.49,1344.9 1684.08,1350.37 1705.67,1355.78 1727.26,1361.16 1748.85,1366.53 1770.45,1371.89 1792.04,1377.25 1813.63,1382.59 1835.22,1387.91 1856.81,1393.2 
  1878.4,1398.45 1899.99,1403.67 1921.58,1408.84 1943.17,1413.94 1964.76,1418.96 1986.36,1423.88 2007.95,1428.71 2029.54,1433.42 2051.13,1438.01 2072.72,1442.48 
  2094.31,1446.81 2115.9,1451.01 2137.49,1455.08 2159.08,1459 2180.68,1462.76 2202.27,1466.38 2223.86,1469.84 2245.45,1473.14 2267.04,1476.29 2288.63,1479.3 
  
  "/>
<path clip-path="url(#clip6100)" d="
M1989.93 251.724 L2280.76 251.724 L2280.76 130.764 L1989.93 130.764  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6100)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1989.93,251.724 2280.76,251.724 2280.76,130.764 1989.93,130.764 1989.93,251.724 
  "/>
<polyline clip-path="url(#clip6100)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  2013.93,191.244 2157.93,191.244 
  "/>
<g clip-path="url(#clip6100)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2181.93, 208.744)" x="2181.93" y="208.744">y1</text>
</g>
</svg>
<p>And let&#39;s check what we got</p><pre><code class="language-julia">fig2 = plot(1:1&lt;&lt;6, trained_pg; label=&quot;trained&quot;)
plot!(fig2, 1:1&lt;&lt;6, pg; label=&quot;target&quot;)
title!(&quot;distribution&quot;)
xlabel!(&quot;x&quot;); ylabel!(&quot;p&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip6700">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6700)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6701">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip6700)" d="
M102.74 1505.26 L2352.76 1505.26 L2352.76 62.9921 L102.74 62.9921  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6702">
    <rect x="102" y="62" width="2251" height="1443"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  132.727,1505.26 132.727,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  469.656,1505.26 469.656,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  806.586,1505.26 806.586,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1143.52,1505.26 1143.52,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1480.45,1505.26 1480.45,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1817.37,1505.26 1817.37,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2154.3,1505.26 2154.3,62.9921 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,1477.16 2352.76,1477.16 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,1023.35 2352.76,1023.35 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,569.538 2352.76,569.538 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,115.726 2352.76,115.726 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1505.26 102.74,62.9921 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  132.727,1505.26 132.727,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  469.656,1505.26 469.656,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  806.586,1505.26 806.586,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1143.52,1505.26 1143.52,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1480.45,1505.26 1480.45,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1817.37,1505.26 1817.37,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2154.3,1505.26 2154.3,1483.63 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1477.16 136.49,1477.16 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1023.35 136.49,1023.35 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,569.538 136.49,569.538 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,115.726 136.49,115.726 
  "/>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 132.727, 1559.26)" x="132.727" y="1559.26">0</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 469.656, 1559.26)" x="469.656" y="1559.26">10</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 806.586, 1559.26)" x="806.586" y="1559.26">20</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1143.52, 1559.26)" x="1143.52" y="1559.26">30</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1480.45, 1559.26)" x="1480.45" y="1559.26">40</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1817.37, 1559.26)" x="1817.37" y="1559.26">50</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2154.3, 1559.26)" x="2154.3" y="1559.26">60</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 78.7402, 1494.66)" x="78.7402" y="1494.66">0.00</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 78.7402, 1040.85)" x="78.7402" y="1040.85">0.01</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 78.7402, 587.038)" x="78.7402" y="587.038">0.02</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 78.7402, 133.226)" x="78.7402" y="133.226">0.03</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:84px; text-anchor:middle;" transform="rotate(0, 1227.75, 73.2)" x="1227.75" y="73.2">distribution</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(0, 1227.75, 1639.12)" x="1227.75" y="1639.12">x</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(-90, -50.4901, 784.126)" x="-50.4901" y="784.126">p</text>
</g>
<polyline clip-path="url(#clip6702)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  166.42,1227.61 200.113,1045.89 233.806,1191.52 267.499,1055.38 301.192,952.974 334.885,1293.84 368.578,1229.3 402.271,1069.15 435.964,1276.47 469.656,990.695 
  503.349,888.74 537.042,1106.33 570.735,774.426 604.428,882.627 638.121,681.256 671.814,589.888 705.507,775.618 739.2,780.824 772.893,661.629 806.586,715.128 
  840.279,605.693 873.972,388.256 907.665,674.678 941.358,244.29 975.051,309.227 1008.74,710.915 1042.44,259.556 1076.13,274.017 1109.82,362.962 1143.52,103.811 
  1177.21,489.184 1210.9,162.497 1244.59,432.096 1278.29,775.074 1311.98,194.725 1345.67,352.636 1379.37,487.598 1413.06,394.59 1446.75,385.698 1480.45,543.239 
  1514.14,567.754 1547.83,277.236 1581.52,559.555 1615.22,553.065 1648.91,746.252 1682.6,748.578 1716.3,1003.12 1749.99,507.256 1783.68,764.974 1817.37,982.655 
  1851.07,607.325 1884.76,833.145 1918.45,770.1 1952.15,905.807 1985.84,936.949 2019.53,1160.61 2053.23,926.635 2086.92,1256.65 2120.61,1147.32 2154.3,1393.52 
  2188,1450.96 2221.69,1053.93 2255.38,1464.44 2289.08,1199.29 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  166.42,1284.41 200.113,1260.44 233.806,1234.45 267.499,1206.4 301.192,1176.28 334.885,1144.12 368.578,1109.95 402.271,1073.86 435.964,1035.95 469.656,996.354 
  503.349,955.25 537.042,912.841 570.735,869.364 604.428,825.09 638.121,780.318 671.814,735.376 705.507,690.613 739.2,646.401 772.893,603.124 806.586,561.179 
  840.279,520.962 873.972,482.871 907.665,447.294 941.358,414.603 975.051,385.147 1008.74,359.251 1042.44,337.202 1076.13,319.25 1109.82,305.601 1143.52,296.413 
  1177.21,291.791 1210.9,291.791 1244.59,296.413 1278.29,305.601 1311.98,319.25 1345.67,337.202 1379.37,359.251 1413.06,385.147 1446.75,414.603 1480.45,447.294 
  1514.14,482.871 1547.83,520.962 1581.52,561.179 1615.22,603.124 1648.91,646.401 1682.6,690.613 1716.3,735.376 1749.99,780.318 1783.68,825.09 1817.37,869.364 
  1851.07,912.841 1884.76,955.25 1918.45,996.354 1952.15,1035.95 1985.84,1073.86 2019.53,1109.95 2053.23,1144.12 2086.92,1176.28 2120.61,1206.4 2154.3,1234.45 
  2188,1260.44 2221.69,1284.41 2255.38,1306.39 2289.08,1326.46 
  "/>
<path clip-path="url(#clip6700)" d="
M1893.61 327.952 L2280.76 327.952 L2280.76 146.512 L1893.61 146.512  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1893.61,327.952 2280.76,327.952 2280.76,146.512 1893.61,146.512 1893.61,327.952 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1917.61,206.992 2061.61,206.992 
  "/>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2085.61, 224.492)" x="2085.61" y="224.492">trained</text>
</g>
<polyline clip-path="url(#clip6700)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1917.61,267.472 2061.61,267.472 
  "/>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2085.61, 284.972)" x="2085.61" y="284.972">target</text>
</g>
</svg>
<p>So within 50 steps, we got a pretty close estimation of our target distribution!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../5.shor-9-code/">« Shor&#39;s 9 qubit code</a><a class="docs-footer-nextpage" href="../7.variation-quantum-eigen-solver/">Variational Quantum Eigen Solver »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 12 February 2020 20:42">Wednesday 12 February 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
